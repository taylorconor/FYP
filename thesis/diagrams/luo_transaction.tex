\begin{tikzpicture}
\coordinate (A_T) at (0,3);
\coordinate (A_B) at (0,-1);
\coordinate (A_1) at (0,2.25);
\coordinate (A_2) at (0,1.5);
\coordinate (A_3) at (0,0.25);
\coordinate (A_BL) at (-0.25,-1);
\coordinate (A_BR) at (0.25,-1);

\coordinate (B_T) at (7,3);
\coordinate (B_B) at (7,-1);
\coordinate (B_1) at (7,2.5);
\coordinate (B_2) at (7,1.25);
\coordinate (B_3) at (7,0.5);
\coordinate (B_BL) at (6.75,-1);
\coordinate (B_BR) at (7.25,-1);

\draw[-] (A_BL) -- (A_BR);
\draw[-] (B_BL) -- (B_BR);

\coordinate (L_1) at (8,2.25);
\coordinate (L_2) at (8,1.1);
\coordinate (L_3) at (8,0);

\node at (L_1) {(1)};
\node at (L_2) {(2)};
\node at (L_3) {(3)};

\draw[thick] (A_T)--(A_B);
\draw[thick] (B_T)--(B_B);
\draw (A_T) node[above]{\Large User};
\draw (B_T) node[above]{\Large AP};

\draw[->] (B_1) -- (A_1) node[midway,below] {$n_{AP}$};
\draw[->] (A_2) -- (B_2) node[midway,below]
	{$H = hash(S_{user}(n_{user} || n_{AP}) || n_{user})$};
	
\draw[->] (B_3) -- (A_3) node[text width=5cm,midway,below]
	{$H || location || time || n_{AP} ||$\\
	$S_{group}(H || location || time || n_{AP})$};
\end{tikzpicture}