\begin{tikzpicture}
\coordinate (A_1) at (0,10);
\coordinate (A_2) at (0,9.75);
\coordinate (A_3) at (0,9);
\coordinate (A_8) at (0,5.75);
\coordinate (A_9) at (0,5);
\coordinate (A_10) at (0,1.5);
\coordinate (A_11) at (0,0.25);
\coordinate (A_12) at (0,0);
\coordinate (AF_L) at (-0.25,0);
\coordinate (AF_R) at (0.25,0);

\coordinate (B_1) at (8,10);
\coordinate (B_2) at (8,9.75);
\coordinate (B_3) at (8,9);
\coordinate (B_8) at (8,7.75);
\coordinate (B_9) at (8,7);
\coordinate (B_10) at (8,1.5);
\coordinate (B_11) at (8,0.25);
\coordinate (B_12) at (8,0);
\coordinate (BF_L) at (7.75,0);
\coordinate (BF_R) at (8.25,0);

\draw[thick] (A_1)--(A_2) (A_3)--(A_8) (A_9)--(A_10) (A_11)--(A_12) (AF_L)--(AF_R);
\draw[thick] (B_1)--(B_2) (B_3)--(B_8) (B_9)--(B_10) (B_11)--(B_12) (BF_L)--(BF_R);
\draw (A_1) node[above]{\Large Node $A$};
\draw (B_1) node[above]{\Large Node $B$};

\draw (A_2) node[below,text centered]{\begin{tabular}{r}
\small{\textit{generate $NL_A[n]$, $ID_{An} = K^{+}_A(NL_A[n])$}}
\end{tabular}};

\draw (B_2) node[below,text centered]{\begin{tabular}{r}
\small{\textit{generate $NL_B[n]$, $ID_{Bn} = K^{+}_B(NL_B[n])$}}
\end{tabular}};

\coordinate (AX_1) at ($(A_3)-(0,0.5)$);
\coordinate (BX_1) at ($(B_3)-(0,1)$);
\draw[->] (AX_1) -- (BX_1) node[midway,below]
	{$T_{req}$: $ID_{An} | ts_A | loc_A$};
	
\draw (B_8) node[below,text centered]{\begin{tabular}{r}
\small{\textit{verify $|ts_A-ts_B| < \epsilon_{ts}$, $|loc_A-loc_B| < \epsilon_{loc}$}}
\end{tabular}};

\coordinate (AX_2) at ($(A_3)-(0,3)$);
\coordinate (BX_2) at ($(B_8)-(0,1)$);
\draw[->] (BX_2) -- (AX_2) node[midway,below]
	{$T_{res}$: $ID_{Bm} | ts_B | loc_B$};
	
\draw (A_8) node[below,text centered]{\begin{tabular}{r}
\small{\textit{verify $|ts_A-ts_B| < \epsilon_{ts}$, $|loc_A-loc_B| < \epsilon_{loc}$}}
\end{tabular}};

\coordinate (AX_3) at ($(A_9)-(0,0.5)$);
\coordinate (BX_3) at ($(B_9)-(0,3)$);
\draw[->] (AX_3) -- (BX_3) node[midway,below]
	{$ID_{An-1}|KP_{An}$};

\coordinate (AX_4) at ($(A_9)-(0,2.5)$);
\coordinate (BX_4) at ($(B_9)-(0,4)$);
\draw[->] (BX_4) -- (AX_4) node[midway,below]
	{$ID_{Bm-1}|KP_{Bm}$};

\draw (A_10) node[below,text centered]{\begin{tabular}{r}
\small{\textit{$T_{An}$ = $KL_{AL}[n](ts|loc|ID_{An}|KP_{Bm})$}}\\
\small{\textit{publish $ID_{An}|KL_{AT}[n](ID_{An-1}|ts_A)|T_{An}$}}
\end{tabular}};

\draw (B_10) node[below,text centered]{\begin{tabular}{r}
\small{\textit{$T_{Bm}$ = $KL_{BL}[m](ts|loc|ID_{Bm}|KP_{An})$}}\\
\small{\textit{publish $ID_{Bm}|KL_{BT}[m](ID_{Bm-1}|ts_B)|T_{Bm}$}}
\end{tabular}};
\end{tikzpicture}